# Custom opentelemetry-collector POC

This is a point of code where I'm building a custom collector of opentelemetry with a custom receiver that simulate receive a accesslog and generate metrics. 


## aclreceiver module

First we had to initiliaze the module with a mock path to enable the import reference in the custom-collector.

In this moudle you will find three files
* `config.go`
* `factory.go`
* `aclreceiver.go`

Here the most important is file is the aclreceiver which implement the `start` and `shutdown` methods that handle the receiver.
Initialy it was made with a ticker system because was take as an example of an scrape interval.

## Toolings

A custom collector was necessary make to can build the aclreceiver. It was autogenerated with de `ocb` tool, that need a `builder.yaml` to indicate which otel components will be used 

To install run the following command: 

* linux intel installer 
```
curl --proto '=https' --tlsv1.2 -fL -o ocb \
https://github.com/open-telemetry/opentelemetry-collector-releases/releases/download/cmd%2Fbuilder%2Fv0.107.0/ocb_0.107.0_linux_amd64
chmod +x ocb
```
* macOS ARM installer

```
curl --proto '=https' --tlsv1.2 -fL -o ocb \
https://github.com/open-telemetry/opentelemetry-collector-releases/releases/download/cmd%2Fbuilder%2Fv0.107.0/ocb_0.107.0_darwin_arm64
chmod +x ocb
```


## Running the custom receiver 

To run the customer receiver you can use the following command:

`go run ./custom-collector --config config.yaml` 

